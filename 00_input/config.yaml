# ===================================================================
#           Multiscale2 Workflow Configuration File
# ===================================================================

# -------------------------------------------------------------------
# [ Global Parameters ] - Applicable to the whole project
# -------------------------------------------------------------------
project_name: "TDP43_condensate_example"

input_files:
  sequence_fasta: "00_input/protein.fasta"
  restraint_reference_pdb: "00_input/reference_structure.pdb"

# -------------------------------------------------------------------
# [ Stage 1: Coarse-Grained CALVADOS Simulation ]
# -------------------------------------------------------------------
cg_calvados:
  platform: "CUDA"
  temp: 310.0
  box: [25.0, 25.0, 30.0]
  steps: 100000 # Short for example
  wfreq: 1000
  logfreq: 1000
  sysname: "cg_sim"
  eps_lj: 0.2
  ionic: 0.15
  pH: 7.0
  restart: null
  frestart: "restart.chk"
  topol: "random"

# -------------------------------------------------------------------
# [ Stage 2: Backmapping ]
# -------------------------------------------------------------------
backmap:
  tool: "cg2all"
  cg_bead_name: "CA"
  fix_sidechains: true

# -------------------------------------------------------------------
# [ Stage 3: OpenMM Structure Refinement ]
# -------------------------------------------------------------------
openmm_refine:
  gromacs_share_dir: "/usr/local/gromacs/share/gromacs/top/" # Example path
  epsilon_r: 15.0
  minimization:
    stage1_max_iterations: 1000
    stage1_tolerance: 100.0
    stage2_max_iterations: 1000
    stage2_tolerance: 200.0

# -------------------------------------------------------------------
# [ Stages 4 & 5: GROMACS - PACE Simulation ]
# -------------------------------------------------------------------
gromacs_pace:
  forcefield: "pace-new" # Custom FF, user must have this in their GMX path
  water_model: "cg300water"
  box_type: "dodecahedron"
  box_distance: 1.2
  ion_conc: 0.15
  neutralize: true
  num_chains: 20 # Example, should match components.yaml

  equilibration:
    nvt_steps: 10000
    npt_steps: 20000
    temperature: 310.0
    pressure: 1.0
    use_contact_restraints: true
    restraint_domains:
      - [4, 76]
      - [106, 176]
      - [192, 259]
      - [320, 328]

  production:
    steps: 50000 # Short for example
    dt: 0.002
    temperature: 310.0
    pressure: 1.0
    output_freq: 1000

# -------------------------------------------------------------------
# [ Stage 6: PACE to All-Atom (AA) Transition ]
# -------------------------------------------------------------------
aa_transition:
  scheme: "reconstruction"

# -------------------------------------------------------------------
# [ Stage 7: GROMACS - All-Atom (AA) Simulation ]
# -------------------------------------------------------------------
gromacs_aa:
  forcefield: "amber99sbws-stq"
  water_model: "tip4p2005s"
  box_type: "dodecahedron"
  box_distance: 1.2
  ion_conc: 0.15
  neutralize: true
  # ... other AA params